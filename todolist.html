<html>
  <head>
    <link rel="stylesheet" href="css/todolist.css" />
    <script src="js/main.js"></script>
    <script>
            function editdeleteupdate(taskobj) {
        let html = "";
        let addtasklist = document.getElementById("addtasklist");
        html += " <tbody class='data-style' id='addtasklist'>";
        let i;
        for (i = 0; i < taskobj.length; i++) {
          html += `<tr>
            <td class='content'> ${taskobj[i].fname} ${taskobj[i].lname}</td>
            <td class='content'> ${taskobj[i].countrycode}</td>
            <td class='content'> ${taskobj[i].mobilenumber}</td>
            <button id="edittask" onclick="editupdate(${taskobj[i].id})"><img src='./icons/edit.png' /></button>
            
            <button id='deletetask' onclick='deleteupdatetask(${taskobj[i].id})'><img class='delete' src='./icons/delete.png' /></button>
            </tr>
            `;
        }
        html += "</tbody>";

        addtasklist.innerHTML = html;
      }
    </script>
  </head>
  <body>
    <div class="data-div" id="opendatatable">
      <div class="div-style">
        <table class="table-div">
          <caption class="caption-style">
            Contact details
          </caption>
          <thead class="data-style">
            <tr>
              <th class="content">Name</th>
              <th class="content">Country code</th>
              <th class="content">Mobile number</th>
            </tr>
          </thead>
          <tbody class="data-style" id="addtasklist">
            <script>
               let webtask = localStorage.getItem("localtask");
        if (webtask == null) {
          taskobj = [];
        } else {
          taskobj = JSON.parse(webtask);
        }
        console.log(taskobj, "jhdbhdh")
        let i;
        // for (i = 0; i < taskobj.length; i++) {
          // taskobj.map ((item) => {
          //   return
          //  <tr>
          //   <td class='content'> {item.fname} {item.lname}</td>
          //   <td class='content'> {item.countrycode}</td>
          //   <td class='content'> {item.mobilenumber}</td>
          //   <button id="edittask" onclick={`${editupdate(item.id)}`}><img src='./icons/edit.png' /></button>
          //   <button id='deletetask' onclick={`${deleteupdatetask(item.id)}`}><img class='delete' src='./icons/delete.png' /></button>

          //   </tr>

          // })
          // editdeleteupdate(taskobj)
        //   let html = "";
        // let addtasklist = document.getElementById("addtasklist");
        // html += " <tbody class='data-style' id='addtasklist'>";
        // // let i;
        // for (i = 0; i < taskobj.length; i++) {
        //   html += `<tr>
        //     <td class='content'> ${taskobj[i].fname} ${taskobj[i].lname}</td>
        //     <td class='content'> ${taskobj[i].countrycode}</td>
        //     <td class='content'> ${taskobj[i].mobilenumber}</td>
        //     <button id="edittask" onclick="editupdate(${taskobj[i].id})"><img src='./icons/edit.png' /></button>
            
        //     <button id='deletetask' onclick='deleteupdatetask(${taskobj[i].id})'><img class='delete' src='./icons/delete.png' /></button>
        //     </tr>
        //     `;
        // }
        // html += "</tbody>";

        // addtasklist.innerHTML = html;
          

        editdeleteupdate(taskobj);



        
      
          </script>
          </tbody>
        </table>
        <div class="button-div">
          <button
            onclick="document.getElementById('modal').style.display='block'"
            class="buttonFirst"
          >
            Add contacts
          </button>
        </div>
      </div>
    </div>
    <div class="main-div" id="modal">
      <div class="removeicon">
        <img src="./icons/remove.png" onclick="removemodal()" />
      </div>
      <script>
        function removemodal() {
          // alert("lsjc")
          document.getElementById("modal").style.display = "none";
          document.getElementById("opendatatable").style.display = "block";
          document.getElementById("opendatatable").style.opacity = "1";
        }
      </script>

      <div class="div">
        <h1 class="header">Enter details</h1>
        <div class="input-main-div">
          <div>
            <label class="label">First Name</label>
            <input
              class="input-div"
              placeholder="Enter your first name"
              id="addtaskinput"
            />
          </div>
          <div>
            <label class="label">Last Name</label>

            <input
              class="input-div"
              placeholder="Enter yout last name"
              id="addlname"
            />
          </div>
          <label class="label">Mobile number</label>

          <div class="input-one-row">
            <input
              type="number"
              class="input-row"
              required
              placeholder="+"
              id="addcountrycode"
            />

            <input
              type="number"
              min="10"
              max="10"
              required
              class="input-number"
              placeholder="Enter mobile number"
              id="addnumber"
            />
          </div>
        </div>
        <button class="button" id="addtaskbtn">Submit</button>
        <button class="button" id="savetask" style="display: none;">Save</button>
      
      </div>
    </div>
    <script>
      document.getElementById("addtaskbtn").onclick = function () {
        document.getElementById("opendatatable").style.display = "block";
        document.getElementById("modal").style.display = "none";
        let datakeys = {
          fname: "",
          lname: "",
          countrycode: "",
          mobilenumber: "",
          id: "",
        };

        let addtaskinput = document.getElementById("addtaskinput").value;
        let addlname = document.getElementById("addlname").value;
        let addcountrycode = document.getElementById("addcountrycode").value;
        let addnumber = document.getElementById("addnumber").value;
        datakeys.fname = addtaskinput;
        datakeys.lname = addlname;
        datakeys.countrycode = addcountrycode;
        datakeys.mobilenumber = addnumber;
        if (addtaskinput == "") {
          document.getElementById("modal").style.display = "block";
          alert("Please enter your first name");
        } else if (addlname == "") {
          document.getElementById("modal").style.display = "block";
          alert("Please enter your last name");
        } else if (addcountrycode == "") {
          document.getElementById("modal").style.display = "block";
          alert("Please enter country code");
        } else if (addnumber == "") {
          document.getElementById("modal").style.display = "block";
          alert("Please enter mobile number ");
        } else {
          alert("done");
          let taskobj = [];
          let webtask = localStorage.getItem("localtask");
          if (!webtask) {
            taskobj = [];
          } else {
            taskobj = JSON.parse(webtask);
            datakeys.id = webtask.length + 1;
          }
          taskobj.push(datakeys);
          localStorage.setItem("localtask", JSON.stringify(taskobj));

          document.getElementById("addtaskinput").value = "";
          document.getElementById("addlname").value = "";
          document.getElementById("addcountrycode").value = "";
          document.getElementById("addnumber").value = "";

          showtask();
        }
      };
      function showtask() {
        let webtask = localStorage.getItem("localtask");
        if (webtask == null) {
          taskobj = [];
        } else {
          taskobj = JSON.parse(webtask);
        }

        editdeleteupdate(taskobj);
      }

      function editupdate(edittask) {
        alert("lsjc");
        document.getElementById("modal").style.display = "block";
        document.getElementById("opendatatable").style.opacity = "0.5";
        let addtaskbtn = document.getElementById("addtaskbtn").style.display = 'none';
        console.log(edittask,"f")
        let savetask = document.getElementById("savetask").style.display = 'block';

        const abc = taskobj.find((data) => data.id == edittask);
        console.log(abc, "jkd");
        let addtaskinput = (document.getElementById("addtaskinput").value =
          abc.fname);
        let addlname = (document.getElementById("addlname").value = abc.lname);
        let addcountrycode = (document.getElementById("addcountrycode").value =
          abc.countrycode);
        let addnumber = (document.getElementById("addnumber").value =
          abc.mobilenumber);
          localStorage.setItem("editid", edittask)
        // editdeleteupdate(taskobj);
      }
      document.getElementById("savetask").onclick = function () {
        document.getElementById("opendatatable").style.display = "block";
        document.getElementById("modal").style.display = "none";
        let datakeys = {
          fname: "",
          lname: "",
          countrycode: "",
          mobilenumber: "",
          id: "",
        };

        let addtaskinput = document.getElementById("addtaskinput").value;
        let addlname = document.getElementById("addlname").value;
        let addcountrycode = document.getElementById("addcountrycode").value;
        let addnumber = document.getElementById("addnumber").value;
        datakeys.fname = addtaskinput;
        datakeys.lname = addlname;
        datakeys.countrycode = addcountrycode;
        datakeys.mobilenumber = addnumber;
        if (addtaskinput == "") {
          document.getElementById("modal").style.display = "block";
          alert("Please enter your first name");
        } else if (addlname == "") {
          document.getElementById("modal").style.display = "block";
          alert("Please enter your last name");
        } else if (addcountrycode == "") {
          document.getElementById("modal").style.display = "block";
          alert("Please enter country code");
        } else if (addnumber == "") {
          document.getElementById("modal").style.display = "block";
          alert("Please enter mobile number ");
        } else {
          alert("done");
          let taskobj = [];
          let webtask = localStorage.getItem("localtask");
          if (!webtask) {
            taskobj = [];
          } else {
            taskobj = JSON.parse(webtask);
            console.log(taskobj, "task")
            console.log(datakeys,"data")
           const editdetails = localStorage.getItem("editid")
            datakeys.id = parseInt(editdetails);
            console.log(datakeys.id, "aaaaaaaaa")
             taskobj.filter((data) => data.id === datakeys.id).map((item) => {
              item.fname = addtaskinput;
              item.lname = addlname;
              item.countrycode = addcountrycode;
              item.mobilenumber = addnumber;
              return item;
            })
            
            console.log(datakeys, "datakeys")
            // taskobj.push(datakeys);
          localStorage.setItem("localtask", JSON.stringify(taskobj));
          document.getElementById('opendatatable').style.opacity = 1;
          }
        }
        showtask();

      }



      function deleteupdatetask(deletetask) {
        console.log(deletetask, "aaa");
        const abc = taskobj.filter((data) => data.id !== deletetask);
        // console.log(abc, "jdhnk")
        taskobj = abc;
        console.log(taskobj, "6532");
        localStorage.setItem("localtask", JSON.stringify(taskobj));
        console.log(abc, "ywghjr");
        editdeleteupdate(taskobj);
      }
    </script>
  </body>
</html>
